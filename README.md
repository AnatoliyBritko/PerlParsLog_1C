# PerlParsLog_1C
Perl cкрипты для парса логов ТЖ
---
**CALL_BD.pl** - выводит время вызова без учета времени затраченное на СУБД (с учетом многострочного контекста собятия DBMSSQL).
Пример результата:

>>Система.ПолучитьФорму:ЖурналДокументов.ЖурналОпераций.Форма.ФормаСписка;ОбщаяФорма.ФормаСтарт;ОбщаяФорма.СУ_ПодписаниеДокументов;ОбщаяФор>ма.ФормаВыбораТекущейОрганизации;Обработка.ИнформационныйЦентр.Форма.ИнформационныйЦентр;Обработка.ПолнотекстовыйПоискВДанных.Форма.Упрощ>еннаяФорма-6822000 (~6.82 сек.)
>>ОбщийМодуль.Вызов:ОбщийМодуль.ЛицензированиеСервер.Модуль.ПриНачалеРаботыСистемы-6442992 (~6.44 сек.)
>>Система.ПолучитьФорму:Документ.РегистрацияОбязательствИСведенийПоДоговорам.ФормаОбъекта-5164006 (~5.16 сек.)
  

**parsMemory.pl** - Парс логов для работы с методикой https://kb.1c.ru/articleView.jsp?id=86.
В методики описан подход для анализа потребления памяти сеансовыми данными, скрипт написал без учета 
ISeanceContextStorage и seanceParametersPresave, т.е. для общего анализа потребления памяти.

**CallDurationsMem.pl** - Скрипт анализирует событие CALL, агрегирует длительность и потребление памяти за вызов. Принимает параметры topn – где n – число, сколько строк нужно вывести, например top10 значит показать первые 10 строк результата.
Так же может принимать параметр SortByMem, данный параметр означает, что сортировка будет по потреблению памяти (без этого параметра будет сортироваться по длительности). 
Пример результата:
cat callscall/rphost_2624/18070511.log | perl 'D:/GIT/Perl/callDurationsMem.pl' top10
>>ОбщийМодуль.Вызов:ОбщийМодуль.СУ.Модуль.ИзменитьСтатусОбъекта - ~ 2785.19 сек., ~ 46.42 мин.
>>Система.ПолучитьФорму:ОбщаяФорма.РасшифровкаРегламентированногоОтчетаЗарплата - ~ 1236.04 сек., ~ 20.60 мин.
>>Форма.Вызов:Документ.АктСверкиВзаиморасчетов.Форма.ФормаДокумента.Модуль.ЗаполнитьПоДаннымБухУчетаСервер - ~ 374.56 сек., ~ 6.24 мин.
>>Система.ПолучитьФорму:Документ.СведенияПоДоговору.ФормаОбъекта - ~ 370.23 сек., ~ 6.17 мин.
>>Форма.Прочитать:Документ.СведенияПоДоговору.Форма.ФормаДокумента - ~ 331.01 сек., ~ 5.52 мин.
>>Форма.Вызов:Документ.СведенияПоДоговору.Форма.ФормаДокумента.Модуль.СУ_ОбновитьИнтерфейсНаСервере - ~ 306.86 сек., ~ 5.11 мин.
>>Система.ПолучитьФорму:Отчет.КарточкаСчета.Форма.ФормаОтчета - ~ 302.28 сек., ~ 5.04 мин.
>>Форма.Записать:Документ.ПоступлениеУслугРабот.Форма.ФормаДокумента - ~ 249.75 сек., ~ 4.16 мин.
>>Форма.Прочитать:Документ.РасчетноПлатежныйДокумент.Форма.ФормаДокумента - ~ 228.80 сек., ~ 3.81 мин.

 cat */rphost*/*.log | perl 'D:/GIT/Perl/callDurationsMem.pl' top10 SortByMem
>>Форма.Вызов:Документ.РасчетноПлатежныйДокумент.Форма.ФормаДокумента.Модуль.УправлениеВидимостьюСозданияИного - ~ 3703440.70 Kb., ~3616.64 Mb. (вызов 2987 раз, среднее значение за вызов 1239.85 Kb.)
>>Система.ПолучитьФорму:Документ.РегистрацияОбязательствИСведенийПоДоговорам.Форма.ФормаДокумента - ~ 3581440.74 Kb., ~3497.50 Mb. (вызов 928 раз, среднее значение за вызов 3859.31 Kb.)
>>Форма.Вызов:Документ.СведенияПоДоговору.Форма.ФормаДокумента.Модуль.СУ_ОбновитьИнтерфейсНаСервере - ~ 2651309.93 Kb., ~2589.17 Mb. (вызов 964 раз, среднее значение за вызов 2750.32 Kb.)
>>Форма.Вызов:Документ.СведенияПоДоговору.Форма.ФормаДокумента.Модуль.ПолучателиГрафика_ВычислимыеПоля_Заполнить - ~ 2546719.36 Kb., ~2487.03 Mb. (вызов 1682 раз, среднее значение за вызов 1514.10 Kb.)
>>Система.ПолучитьФорму:Отчет.КарточкаСчета.Форма.ФормаОтчета - ~ 2350753.16 Kb., ~2295.66 Mb. (вызов 419 раз, среднее значение за вызов 5610.39 Kb.)
>>Форма.Прочитать:Документ.РасчетноПлатежныйДокумент.Форма.ФормаДокумента - ~ 2307492.37 Kb., ~2253.41 Mb. (вызов 1599 раз, среднее значение за вызов 1443.08 Kb.)
>>Система.ПолучитьФорму:Документ.СведенияПоДоговору.ФормаОбъекта - ~ 2196117.14 Kb., ~2144.65 Mb. (вызов 358 раз, среднее значение за вызов 6134.41 Kb.)
>>Форма.Прочитать:Документ.СведенияПоДоговору.Форма.ФормаДокумента - ~ 1786141.50 Kb., ~1744.28 Mb. (вызов 660 раз, среднее значение за вызов 2706.28 Kb.)
>>Форма.Вызов:Документ.РасчетноПлатежныйДокумент.Форма.ФормаДокумента.Модуль.СУ_ОбновитьИнтерфейсНаСервере - ~ 1622865.40 Kb., ~1584.83 Mb. (вызов 1042 раз, среднее значение за вызов 1557.45 Kb.)